#! /usr/bin/make -f

## See debhelper(7) (uncomment to enable).
## Output every command that modifies files on the build system.
export DH_VERBOSE = 1


# amd64 build prep
ifeq (amd64,$(DEB_HOST_ARCH))
	override_dh_prep:
		# Extract nvidia files from run archive
		./nvidia-installer.run  --extract-only
		mkdir -p debian/tmp
		# Copy installer contents into debian temp dir
		cp -rf ./NVIDIA-Linux-*/* debian/tmp
		# Delete 32 libs on amd64 builds
		rm -rf debian/tmp/32
		# Extract all manpages
		gunzip debian/tmp/*.1.gz -k
endif
	
# i386 (x86) build prep
ifeq (i386,$(DEB_HOST_ARCH))
	override_dh_prep:
		# Extract nvidia files from run archive
		./nvidia-installer.run  --extract-only
		mkdir -p debian/tmp
		cp -rf ./NVIDIA-Linux-*/32/* debian/tmp
endif
%:
	dh $@
